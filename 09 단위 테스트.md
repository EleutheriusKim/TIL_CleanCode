# 들어가면서
> 제대로 된 테스트 케이스를 작성해야 한다는 사실을 잊지말자    

과거 1997년까지만 하더라도 TDD라는 개념을 아무도 몰랐다.       
대다수의 프로그래머들은 **'단위 테스트'** 를 돌아가는지 확인하기 위한 **일회용 코드라 여겼다.**    
       
시간이 지나면서 '테스트 코드'는 눈부신 성장을 이뤘고             
애자일과 TDD 덕택에 단위 테스트를 자동화하는 프로그래머들이 많아지고 있다.             
하지만, 많은 프로그래머들이 단위 테스트를 도입하려고 급하게 서두르면서도          
**제대로 된 테스트 케이스를 작성해야 한다는 좀 더 미묘한 사실을 놓치고 있는 중이다.**     

# TDD 법칙 3가지  
> TDD, 실제 코드를 작성하기 전에 단위 테스트를 작성하자     
     
* **첫 번째 법칙 :** 실패하는 단위 테스트를 작성할 때까지 실제 코드를 작성하지 않는다.        
* **두 번째 법칙 :** 컴파일은 실패하지 않으면서 실행이 실행이 실패하는 정도로만 단위 테스트를 작성한다.   
* **세 번째 법칙 :** 현재 실패하는 테스트를 통과할 정도로만 실제 코드를 작성한다.   
   
위 3가지 규칙을 따른다면   
* 테스트 코드와 실제 코드가 함께 나온다.   
* 실제 코드를 사실상 전부 테스트하는 수천 개의 테스트 코드가 나온다.  
  * 단, 너무 많은 테스트 코드는 오히려 심각한 관리 문제를 유발한다.   
    
# 깨끗한 테스트 코드 유지하기 
대부분의 프로그래머들은 시간에 쫒긴다.   
그러다보니 테스트 코드도 '지저분해도 빨리'라는 생각을 한다.   
하지만, 실제 코드가 진화하면 테스트 코드도 진화(변화)해야한다.   
  
**그렇기 때문에...**          
* 테스트 코드가 지저분할수록 변경하기 어려워진다.     
* 테스트 코드가 복잡할수록 실제 코드를 짜는 시간보다 테스트 케이스를 추가하는 시간이 더 오래 걸린다.    
* 테스트 코드가 실패하면 지저분한 코드로 인해 실패 테스트 케이스를 통과하기 어려워진다.      
* 새 버전 출시할 때마다 팀이 테스트 케이스를 유지하고 보수하는 비용도 늘어난다.     
         
반면에, 테스트 코드를 깨끗하게 짰다면 위와 같은 문제는 나오지 않을 것이다.    
**테스트 코드는 실제 코드 못지 않게 중요하다**    
테스트 코드는 사고와 설계와 주의가 필요하므로 실제 코드 못지 않게 깨끗하게 짜야한다.     

## 테스트 코드는 우연성, 유지보수성, 재사용성을 재공한다.  
코드에 우연성, 유지보수성, 재사용성을 제공하는 버팀목은 **단위 테스트**이다.        
* 테스트 코드를 깨끗하게 유지하지 않으면 결국 잃어버린다.        
* 테스트 케이스가 없으면 실제 코드를 유연하게 만드는 버팀목도 사라진다.    
   
테스트 케이스가 없다면?   
* 코드를 변경하면 어떤 에러가 생길지 모른다는 두려움이 생긴다.  
* 아키텍처가 아무리 유연하더라도, 설계를 아무리 잘 나눴더라도 마찬가지이다.   
* 코드를 변경했을 때 그에 맞는 테스트를 진행하지 않으므로 '검증'이 안 된다.     
   
테스트 케이스가 있다면?   
* 테스트 커버리지가 높을수록 공포는 줄어든다.   
* 아키텍처가 부실하거나 설계가 모호하고 엉망인 코드도 우려 없이 변경할 수 있다.   
* 코드를 변경했을 때 그에 맞는 테스트를 진행하므로 '검증'이 된다.     

그러므로 실제 코드를 점검하는 자동화된 단위 테스트 슈트는 
설계와 아키텍처를 최대한 깨끗하고 보존하는 열쇠다.   
테스트는 유연성, 유지보수성, 재사용성을 제공한다.   
테스트 케이스가 있으면 **변경**이 쉬워지기 때문이다.  

따라서 테스트 코드가 지저분하면 코드를 변경하는 능력은 떨어진다.   
구조를 개선하는 능력도 떨어진다.   
테스트 코드가 지저분할수록 실제 코드도 지저분해진다.   
결국 테스트 코드를 잃어버리고 실제 코드도 망가진다.   

# 깨끗한 테스트 코드  
> 깨끗한 코드를 만들기 위한 3가지 조건 | **가독성, 가독성, 가독성**   
    
테스트 코드에서 가독성은 실제 코드보다 더더욱 중요할 수 있다.      
그리고 실제 코드와 마찬가지로 **명료성**, **단순성**, **풍부한 표현력**이 필요하다.         
테스트 코드는 최소의 표현으로 많은 것을 나타내야하기 때문이다.    

# 도메인에 특화된 테스트 언어    
도메인에 특화된 언어(DSL)로 테스트 코드를 구현하는 기법을 보여준다.      
시스템 조작 API를 사용하는 대신, API 위에다 함수와 유틸리티를 구현한 후 사용하므로     
테스트 코드를 짜기도 읽기도 쉬워진다.      
이렇게 구현한 함수와 유틸리티는 테스트 코드에서 사용하는 특수 API가 된다.       
즉, 테스트를 구현하는 당사자와 나중에 테스트를 읽어볼 독자를 도와주는 **테스트 언어**이다.       




