# 들어가면서   
함수는 어떤 프로그램이든 가장 기본적인 단위가 된다.       
아래 하나의 함수 코드를 줄테니 3분만에 해독을 해보아라       
   
**나쁜 코드**
```java
    public static String testableHtml(PageData pageData, boolean includeSuiteSetup) throws Exception {
        Wikipage wikipage = pageData.getWikiPage();
        StringBuffer buffer = new StringBuffer();
        if (pageData.hasAttribute("Test")) {
            if (includeSuiteSetup) {
                WikiPage suiteSetup = PageCrawlerlmpl.getlnheritedPage(SuiteResponder.SUITE_SETUP_NAME, wikiPage);
                if (suiteSetup != null) {
                    wikiPagePath pagePath = suiteSetup.getPageCrawler().getFullPath(suiteSetup);
                    String pagePathName = PathParser.render(pagePath);
                    buffer.append("include -setup .").append(pagePathName).append("\n");
                }
            }
            WikiPage setup = PageCrawlerlmpl.getInheritedPage("SetUp", wikiPage);
            if (setup != null) {
                WikiPagePath setupPath = wikiPage.getPageCrawler().getFullPath(setup);
                String setupPathName = PathParser.render(setupPath);
                buffer.append("!include -setup .").append(setupPathName).append("\n");
            }
        }
        buffer.append(pageData.getContent());
        if (pageData.hasAttribute("Test")) {
            WikiPage teardown = pageCrawlerlmpl.getInheritedPage("TearDown", wikiPage);
            if (teardown != null) {
                WikiPagePath tearDownPath = wikiPage.getPageCrawler().getFullPath(teardown);
                String tearDownPathName = PathParser.render(tearDownPath);
                buffer.append("\n").append("!include -teardown .").append(tearDownPathName).append("\n");
            }
            if (includeSuiteSetup) {
                WikiPage suiteTeardown = PageCrawlerlmpl.getlnheritedPage(SuiteResponder.SUITE_TEARDOWN_NAME, wikiPage);
                if (suiteTeardown != null) {
                    Wikipagepath pagePath = suiteTeardown.getPageCrawler().getFullPath(suiteTeardown);
                    String pagePathName = PathParser.render(pagePath);
                    buffer.append("!include -teardown .").append(pagePathName).append("\n");
                }
            }
        }
        pageData.setContent(buffer.toString());
        return pageData.getHtml();
    }

```
위 코드는 추상화 수준도 너무 다양하고, 코드도 너무 길다.   
두 겹으로 중첩된 if문은 이상한 플래그를 확인하고, 이상한 문자열을 사용하며, 이상한 함수를 호출한다.   

☑︎ 추상화 수준이란? (출처: https://starkying.tistory.com/entry/clean-code-functions)
```
말 그대로 구체적으로 풀어 쓰기보다는 추상적으로 표현되어 있다면 추상화 수준이 높은 것이고, 
추상화 되어 있지 않고 직접적인 코드는 추상화 수준이 낮다고 한다.
```
하지만 중복된 코드들을 찾아서   
메서드 몇 개를 추출하고, 이름 몇 개를 변경하고, 구조를 조금 변경했더니 코드를 매우 간략히 표현할 수 있었다.     
해당 코드는 아래와 같다.   

**개선 코드**
```java
    public static String renderPageWithSetupsAndTeardowns(PageData pageData, boolean isSuite) throws Exception {
        boolean isTestPage = pageData.hasAttribute("Test");
        if (isTestPage) {
            WikiPage testPage = pageData.getWikiPage();
            StringBuffer newpageContent = new StringBuffer();
            includeSetupPages(testPage, newPageContent, isSuite);
            newPageContent.append(pageData.getContent());
            includeTeardownPages(testPage， newPageContent, isSuite); pageData.setContent(newPageContent.toString());
        } return pageData.getHtml();
    }
```
기존 코드를 짜던 개발자가 아니여서 각 메서드의 동작을 완벽히 이해하지는 못하지만 (FitNess 테스트기반 코드임)   
함수가 설정 페이지와 해제 페이지를 테스트 페이지에 넣은 후 해당 테스트 페이지를 HTML로 렌더링 한다는 사실은 짐작할 수 있다.  
그리고 JUnit에 익숙한 사람은 웹 기반 프레임워크에 속한다는 사실도 알 수 있다.   

그렇다면 왜 기존에는 보이지 않았던 것들이 보여지게 된 것일까?    
* 위 함수가 읽기 쉽고 이해하기 쉬운 이유는 무엇일까?   
* 의도를 분명히 표현하는 함수를 어떻게 구현할 수 있을까?   
* 함수에 어떤 속성을 부여해야 처음 읽는 사람이 프로그램 내부를 직관적으로 파악할 수 있을까?   

[1. 작게 만들어라!](#작게-만들어라!)     

# 작게 만들어라! 
* **함수를 만드는 첫째 규칙은 '작게!'다.**      
* **함수를 만드는 둘째 규칙은 '더 작게!'다.**    
   
위의 것들을 '증명'하라는 것은 어렵지만 무조건 작은 함수가 좋다.        
이렇게 작게 만든 함수들은 각 함수마다 명백하게 하나의 이야기를 표현할 수 있으며 그렇게 해야 한다.        
   
그리고 사실 위의 코드는 더 간략히 줄일 수도 있었다.    

**더 개선 코드**
```java
    public static String renderPageWithSetupsAndTeardowns(PageData pageData, boolean isSuite) throws Exception {
        if (isTestPage(pageData)) {
            includedSetupAndTreadownPages(pageData, isSuite);
        } return pageData.getHtml();
    }
```

## 블록과 들여쓰기   
다시 말해, ```if 문```/```else 문```/```while 문``` 등에 들어가는 블록은 한 줄이어야 한다는 의미이다.   
대개 거기서 함수를 호출한다.       
그러면 바깥을 감싸는 함수가 작아질 뿐 아니라, 블록 안에서 호출하는 함수 이름을 적절히 짓는다면, 코드를 이행하기도 쉬워진다.       
   
이말은 중첨 구조가 생길만큼 함수가 커져서는 안 된다는 뜻이다.   
**그러므로 함수에서 들여쓰기 수준은 1단이나 2단을 넘어서면 안된다.**   
당연한 말이지만 그래야 함수는 읽고 이해하기 쉬워진다.   




asd

 
